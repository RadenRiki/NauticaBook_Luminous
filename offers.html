<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="styles2.css">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.4.0/fonts/remixicon.css" rel="stylesheet">
  <title>Offers</title>
  <style>
    /* Tambahkan style untuk referral form */
    .referral-container {
      max-width: 500px;
      margin: 2rem auto;
      text-align: center;
      padding: 1.5rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .referral-input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #eee;
      border-radius: 8px;
      font-size: 1rem;
      margin-bottom: 1rem;
    }

    .referral-btn {
      background: var(--primary-color);
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .referral-btn:hover {
      background: var(--primary-color-dark);
    }

    /* Style untuk offer spesial */
    .special-offer {
      border: 2px solid var(--primary-color);
      position: relative;
      overflow: hidden;
    }

    .special-offer::before {
      content: "Special Offer!";
      position: absolute;
      top: 10px;
      right: -30px;
      background: var(--primary-color);
      color: white;
      padding: 5px 40px;
      transform: rotate(45deg);
      font-size: 0.8rem;
    }

    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <!-- Navigation -->
  <nav>
    <div class="nav__logo" onclick="window.location.href='home.php'">NauticaBook</div>
    <ul class="nav__links">
      <li class="link"><a href="home.php">Home</a></li>
      <li class="link"><a href="myticket.php">MyTickets</a></li>
      <li class="link"><a href="offers.php">Offers</a></li>
    </ul>
    <div class="profile-icon" onclick="window.location.href='profile.php'">
      <i class="ri-user-3-line"></i>
    </div>
  </nav>

  <!-- Tambahkan form referral sebelum offers section -->
  <div class="referral-container">
    <h2>Punya kode referral?</h2>
    <p>Masukkan kode referral teman untuk mendapatkan penawaran spesial!</p>
    <input type="text" id="referralInput" class="referral-input" placeholder="Masukkan kode referral">
    <button onclick="checkReferral()" class="referral-btn">Cek Referral</button>
  </div>

  <!-- Offers Section -->
  <section class="section__container offers__container">
    <h1>Best Offers</h1>
    <div class="offers__grid">
      <!-- Special offer (hidden by default) -->
      <div class="offer__card special-offer hidden" id="specialOffer">
        <img src="assets/special-offer.jpg" alt="Special Offer" class="offer__image">
        <div class="offer__content">
          <h2 class="offer__title">Diskon Spesial Referral 30%!</h2>
          <p class="offer__description">Selamat! Anda mendapatkan diskon spesial 30% untuk pemesanan pertama!</p>
        </div>
      </div>

      <!-- Offer 1 -->
      <div class="offer__card" onclick="openOfferDetails('Offer 1')">
        <img src="assets/Bali.jpeg" alt="Offer 1" class="offer__image">
        <div class="offer__content">
          <h2 class="offer__title">Diskon Spesial menuju Bali</h2>
          <p class="offer__description">Dapatkan diskon sebanyak 20% jika membeli tiket menuju bali minggu ini!</p>
        </div>
      </div>

      <!-- Offer 2 -->
      <div class="offer__card" onclick="openOfferDetails('Offer 2')">
        <img src="assets/Free Vector _ Sale web banner for social media.jpeg" alt="Offer 2" class="offer__image">
        <div class="offer__content">
          <h2 class="offer__title">Diskon Early Bird</h2>
          <p class="offer__description">Bangun pagi-pagi, eh malah dapat Diskon gede nih.</p>
        </div>
      </div>

      <!-- Offer 3 -->
      <div class="offer__card" onclick="openOfferDetails('Offer 3')">
        <img src="assets/Top 30 Best Family Holiday Destinations You Need to Visit!.jpeg" alt="Offer 3" class="offer__image">
        <div class="offer__content">
          <h2 class="offer__title">Paket Keluarga</h2>
          <p class="offer__description">Jalan-jalan keluarga spesial dengan harga spesial yuk!</p>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="section__container footer__container">
      <div class="footer__col">
        <h3>NauticaBook</h3>
        <p>
          NauticaBook adalah platform untuk booking ferry dan cargo secara cepat dan terpercaya.
          Pengguna dapat mencari jadwal, membandingkan harga, dan memesan tiket dengan mudah dalam beberapa langkah.
        </p>
        <p>
          NauticaBook menawarkan antarmuka ramah pengguna untuk pengalaman pemesanan nyaman,
          baik untuk perjalanan pribadi, bisnis, maupun logistik. Dengan mitra terpercaya,
          layanan pelanggan responsif, dan sistem pembayaran aman, NauticaBook memenuhi kebutuhan transportasi laut
          Anda.
        </p>
      </div>
      <div class="footer__col">
        <h4>Tim Luminous</h4>
        <p>Raden Riki Hilviastari Saputra (23523217)</p>
        <p>Arvindra Ahmad Ramadhan (23523128)</p>
        <p>Taqya Maritsa Hakim (23523108)</p>
        <p>Tazki Ulil Absar (23523208)</p>
      </div>
    </div>
    <div class="footer__bar">
      Copyright Â© 2024 Webs by Luminous. All rights reserved.
    </div>
  </footer>

  <script>
    // Fungsi untuk memeriksa status referral saat halaman dimuat
    document.addEventListener('DOMContentLoaded', () => {
      const hasReferral = localStorage.getItem('hasReferral');
      if (hasReferral === 'true') {
        document.getElementById('specialOffer').classList.remove('hidden');
      }
    });
  
    async function checkReferral() {
      const referralCode = document.getElementById('referralInput').value.trim();
      
      if (referralCode === "") {
        alert('Silakan masukkan kode referral.');
        return;
      }
  
      try {
        const response = await fetch('check_referral.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ referral: referralCode })
        });
  
        const data = await response.json();
        
        if (data.valid) {
          // Simpan status referral di localStorage
          localStorage.setItem('hasReferral', 'true');
          
          // Tampilkan special offer
          document.getElementById('specialOffer').classList.remove('hidden');
          alert('Selamat! Anda mendapatkan penawaran spesial!');
        } else {
          alert('Kode referral tidak valid. Silakan coba lagi.');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Terjadi kesalahan. Silakan coba lagi.');
      }
    }
  
    // Optional: Fungsi untuk menghapus status referral
    function clearReferral() {
      localStorage.removeItem('hasReferral');
      document.getElementById('specialOffer').classList.add('hidden');
    }
  </script>  
</body>

</html>